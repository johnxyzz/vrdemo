<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>teste movimento</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.0.0/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script>

</head>
<body>
    
    <a-scene>
        <!-- Luz para iluminar a cena -->
        <a-light type="ambient" color="#888"></a-light>
        <a-light type="directional" position="0 1 0"></a-light>
      
        <!-- Câmera com controles para olhar ao redor -->
        <a-entity id="camera" camera look-controls position="0 1.6 0">
          <a-cursor></a-cursor>
        </a-entity>
      
        <!-- Cubo que será movido -->
        <a-box id="player" color="red" position="0 1.6 -5" depth="1" height="1" width="1"></a-box>
      
        <!-- Chão da cena -->
        <a-plane rotation="-90 0 0" width="20" height="20" color="#7BC8A4"></a-plane>
      
        <!-- Sky -->
        <a-sky color="#ECECEC"></a-sky>
      
        <script>
          var moveForward = false;
          var moveBackward = false;
          var moveLeft = false;
          var moveRight = false;
      
          document.addEventListener('keydown', function(event) {
            switch (event.key) {
              case 'w': moveForward = true; break;
              case 's': moveBackward = true; break;
              case 'a': moveLeft = true; break;
              case 'd': moveRight = true; break;
            }
          });
      
          document.addEventListener('keyup', function(event) {
            switch (event.key) {
              case 'w': moveForward = false; break;
              case 's': moveBackward = false; break;
              case 'a': moveLeft = false; break;
              case 'd': moveRight = false; break;
            }
          });
      
          // Função de loop contínuo para atualização de posição
          function movePlayer() {
            var player = document.querySelector('#player');
            var camera = document.querySelector('#camera');
            var playerPosition = player.getAttribute('position');
            
            // Pegue a rotação da câmera
            var cameraRotation = camera.getAttribute('rotation');
            
            // Converta a rotação Y da câmera (ângulo de yaw) para radianos
            var angleRad = THREE.MathUtils.degToRad(cameraRotation.y);
            
            var speed = 0.05; // Ajuste a velocidade
      
            // Movimentos
            if (moveForward) {
              playerPosition.x += Math.sin(angleRad) * speed;
              playerPosition.z += Math.cos(angleRad) * speed;
            }
            if (moveBackward) {
              playerPosition.x -= Math.sin(angleRad) * speed;
              playerPosition.z -= Math.cos(angleRad) * speed;
            }
            if (moveLeft) {
              playerPosition.x -= Math.sin(angleRad - Math.PI / 2) * speed;
              playerPosition.z -= Math.cos(angleRad - Math.PI / 2) * speed;
            }
            if (moveRight) {
              playerPosition.x -= Math.sin(angleRad + Math.PI / 2) * speed;
              playerPosition.z += Math.cos(angleRad + Math.PI / 2) * speed;
            }
      
            // Atualiza a posição do cubo
            player.setAttribute('position', playerPosition);
      
            // Loop contínuo para atualizar a posição
            requestAnimationFrame(movePlayer);
          }
      
          // Inicia o loop de movimento
          movePlayer();
        </script>
      </a-scene>
      
    

</body>
</html>